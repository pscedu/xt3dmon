.\" $Id$
.Dd July 20, 2006
.Dt XT3DMON 1
.ds volume Pittsburgh Supercomputing Center
.\" .ds vT Pittsburgh Supercomputing Center
.Os http://www.psc.edu/
.Sh NAME
.Nm xt3dmon
.Nd XT3 monitor
.Sh SYNOPSIS
.Nm xt3dmon
.Op Fl dp
.Op Fl c Ar physconf
.Op Fl H Ar height
.Op Fl W Ar width
.Sh DESCRIPTION
.Nm
is a 3D program that graphically displays various data sets of
information about the BigBen Cray
.Tn XT3
cluster.
Data about the cluster nodes are read at startup and can be continually
refreshed so that the display reflects reality.
.Pp
The options are as follows:
.Bl -tag -width Ds
.\" .It Fl a
.\" Enable active stereo mode.
.\" In this mode, if the video hardware supports it,
.\" .Nm
.\" will manage buffers for both the left and right eyes to be
.\" overlaid on the same window.
.It Fl c Ar physconf
Specify an alternative
.Pa phys.conf
machine physical layout description file.
Default is
.Pa data/phys.conf .
.It Fl d
Enable
.Dq daemon
mode \(em that is,
.Nm
will listen on TCP connections to accept requests from clients to
generate screen captures and send the resulting images as
responses.
.It Fl H Ar height
Specify the
.Nm
window height in pixels.
.It Fl p
Enable passive stereo mode.
In this mode, two windows are created and maintained individually,
for use by a stereo projector overlaying the right side of the
available screen space with the left.
.It Fl W Ar width
Specify the
.Nm
window width in pixels.
.El
.Pp
There are a number of different data displays available:
job, yod, temperature, seastar counters, lustre status,
and various routing statistics
(see the key assignments below for how to enable these modes).
Each mode assigns every cluster node a color corresponding to its
status with respect to that display mode.
.Pp
In the job and yod modes, cluster nodes may be in any of the following
states, differentiated by color/texture:
.Pp
.Bl -tag -width "Disabled (PBS)" -offset indent -compact
.It Free
The node is available to run jobs.
.It Disabled (PBS)
The node is not being used to run jobs via PBS.
.It Down (CPA)
The node is marked down by CPA.
.It Used
A job is assigned to and is running on the node.
These nodes are colored by their respective job.
.It Service
The node is a service node, not a compute node.
.El
.Pp
The temperature mode colors each cluster node according to its nearest
temperature class range.
.Pp
The seastar and routing error modes color the nodes based upon the
relative performance of each node to the rest of the nodes.
.Pp
Some modes, such as job mode, provide information about user accounts
on the XT3 system.
As such, accessing this information requires authenticating with a
valid PSC/Kerberos account, which can be set with the
.Ic pL
command.
.Pp
The legend panel (see the
.Ic pl
command) displays all possible node states for the current data
viewing mode.
Each state is accompanied by a color box representing the color in
which nodes of that state will be drawn.
Using the
.Ic + , - , = ,
and
.Ic _
keys over the label will modify the translucency of that node class.
.Pp
The following is a quick reference of the most useful key bindings:
.Pp
.Bl -tag -width Ds -offset indent -compact
.It left, right, up, down
Pan the camera to the left, right, forward, or backward along its
view.
.Pp
.It home, end
.Dq Barrel roll
the camera to the left or right.
.Pp
.It pageup, pagedown
Pan the camera up and down along (perpendicular to) its view.
.Pp
.It left click
Click a node for extended information.
Hold shift and click to toggle the selected state of additional nodes.
.Pp
Click, hold, and drag the mouse to revolve around the point of focus,
normally the cluster view.
.Pp
While holding the shift key, click, hold, and drag the mouse to freely
adjust the camera view.
.Pp
.It Ic 2 , 4 , 6 , 8
Revolve around the point of focus.
.Pp
.It Ic aj
Display only nodes in jobs of any selected nodes.
.Pp
.It Ic O
Move the camera to a bird's eye view of the cluster.
.Pp
.It Ic pa
Toggle all non-interactive panels.
.Pp
.It Ic q
Quit.
.Pp
.It Ic [x , [y , [z , [[
.It Ic ]x , ]y , ]z , ]]
Adjust the wired cluster viewing mode node spacing factor.
.Pp
.It Xo
.Ic {x , {y , {z ,
.Ic {0 , {{
.Xc
.It Xo
.Ic }x , }y , }z ,
.Ic }0 , }}
.Xc
Adjust the wired cluster viewing mode node offset factor.
The key sequences involving zero reset the offset.
.Pp
.It Ic + , _ , = , -
Adjust translucency for the node class under the cursor of the
legend panel.
.El
.Pp
The following additional key bindings are also available:
.Bl -tag -width Ds -offset indent
.It Ic ^A
Select all visible nodes.
.It Ic ar
Display all nodes.
.It Ic as
Display only selected nodes.
.\" .It Ic C
.\" Redraw the cluster.
.It Ic c
Clear the selected node(s).
.It Ic fc
Empty the flyby data file.
By default, enabling recording consecutively will append flyby states to
the file.
.It Ic fl
Toggle the looping of flyby playback.
.It Ic fp
Playback a previously recorded flyby.
Press
.Em space
.Bk -words
.Pq Dq " "
.Ek
to toggle suspension of playback.
Press any other key to break out of playback.
.It Ic fq
Toggle the recording and saving of the live state, for use in flyby
playbacks.
.It Ic i
Print the node IDs (nids) of all selected nodes to standard output.
.It Ic kd
Restore the arrow keys to camera movement (see
.Ic kn
below).
.It Ic kn
Remap the arrow keys to move about the neighbors of any selected nodes.
.Pp
While holding shift, neighbors in the direction of the key pressed will
be selected additionally instead of in place of the currently selected
nodes.
.It Ic kw
Remap the arrow keys to modify the wired cluster viewing mode node
offset factor.
.It Ic M
Maximize window.
.It Ic mj
Switch to job data mode (default).
.It Ic mt
Switch to temperature data mode.
.It Ic my
Switch to yod data mode.
.It Ic od
Toggle screen capture.
Files with sequenced names are written into the
.Pa snaps
directory.
.It Ic oe
Toggle movement interpolation
.Pq Dq tweening .
.It Ic oG
Toggle the frame rate governor.
.It Ic og
Toggle display of the ground and axes.
.It Ic ol
Toggle the display of node labels.
.It Ic oM
Toggle the display of modules.
.It Ic on
Toggle node animation for when nodes move positions.
.It Ic oP
Toggle the display of pipes to the wired neighbors of any selected nodes.
.It Ic op
Toggle the display of pipes to the wired neighbors of all nodes.
.It Ic os
Toggle skeleton mode.
.It Ic ot
Toggle texture mapping.
.It Ic ow
Toggle the display of wireframes around nodes.
.It Ic Pr
Color node pipes according to interconnection router errors.
.It Ic Pd
Color node pipes according to interconnection torus.
.\" .It Ic pc
.\" Toggle the command panel.
.It Ic pd
Toggle the date/time panel.
.It Ic pF
Toggle the flyby overview panel.
.It Ic pf
Toggle the frames-per-second panel.
.It Ic pg
Toggle the goto-node panel.
Enter a node ID (nid) to move to that node.
.It Ic pj
Toggle the goto-job panel.
Enter a job ID to view only that job.
.It Ic pL
Toggle the login panel.
Prompts for a username/password combination to access account-specific
information.
.It Ic pl
Toggle the legend panel.
.It Ic pn
Toggle the extended node information panel.
.It Ic po
Toggle the option panel.
.It Ic pP
Toggle the
.Dq panels
panel \(em one panel to rule them all.
.It Ic pp
Toggle the camera position panel.
.It Ic pS
Toggle the status panel.
.It Ic ps
Toggle the screenshot panel.
.It Ic R
Refresh current data set.
.It Ic r+ , r- , rr
Cycle through the port sets in the routing error data mode.
.It Ic rR , rF , rT
Change the routing error data mode to display recoverable, fatal,
or router errors.
.It Ic vo
Switch to the wired viewing mode with only one cluster drawn.
.It Ic vp
Switch to the physical viewing mode (default).
.It Ic vw
Switch to the wired viewing mode with the cluster drawn continuously.
.It Ic x
Toggle
.Em Deus Ex\&
mode.
See below.
.El
.Sh DEUS EX SYNTAX
.Nm
can have many of its actions scripted by loading a
.Em deus ex
script and running it with the Deus Ex mode.
The syntax and grammar for these scripts are as follows:
.Pp
Empty lines and lines beginning with a
.Sq #
are ignored.
All other lines are expected to contain one action directive,
which may be any of the following:
.Bl -tag -width Ds
.It Ic bird
Move to a bird's eye view.
.It Ic clrsn
Clear any selected nodes.
.It Ic cyclenc
Cycle through each node class (such as jobs or temperature range)
of the current data mode, displaying only one class at a time.
.It Ic dmode Ar dm
Set the data mode.
Recognized values for
.Ar dm
are
.Ic job , temp , rte ,
and
.Ic yod .
.It Ic hl Ar class
Highlight (i.e., only show) nodes in given node
.Ar class .
The following symbolic names are recognized:
.Pp
.Bl -tag -offset indent -width Ds -compact
.It Ic all
Show all node classes.
.It Ic seldm
Show all node classes of any selected node.
.El
.It Ic move Ar dir amt
Pan the camera in the given direction
.Ar dir
the given amount
.Ar amt .
.Ar dir
may be one of
.Ic forward , back .
.Ar amt
is a floating-point or integer number of 3-space units.
.It Xo
.Ic opt
.Op Ar modifier
.Ar option Op , Ar ...
.Xc
Change the view options.
.Ar modifier
may be
.Sq + ,
which enables options,
.Sq - ,
which disables options, or left blank, which sets all current
options to only those specified.
.Pp
The following options are recognized:
.Pp
.Bl -tag -width nodeanimXX -offset indent -compact
.It Ic cabskel
Include cabinents in skeletons.
.It Ic caption
Show captions.
.It Ic frames
Show node wireframes.
.It Ic ground
Show the ground/axes.
.It Ic modskel
Include blades in skeletons.
.It Ic nlabels
Node labels.
.It Ic nodeanim
Animate node movement.
.It Ic pause
Pause until disabled (e.g. by pressing
.Em space ) .
.It Ic pipes
Show pipes representing node interconnections.
.It Ic selnlbls
Node labels for selected nodes.
.It Ic selpipes
Show interconnect pipes for selected nodes.
.It Ic skel
Cluster skeletons.
.It Ic subset
Show a subset of the machine.
See the
.Ic subsel
command.
.It Ic tex
Use textures of solid colors for node fills.
.It Ic tween
Smooth camera movement with .Dq tween steps.
.El
.It Ic orbit Ar dim Op Ar frac
Orbit the current focus point, which will be the center of all
selected nodes, if their are any, or otherwise the entire cluster
view.
.Ar dim
specifies which dimension (e.g.,
.Ic x , y ,
or
.Ic z )
and may be prefixed with a minus sign
.Pq Sq -
to specify reverse revolutions.
.Ar frac
specifies the number of revolutions, which may be fractional,
and defaults to one if unspecified.
.It Xo
.Ic panel
.Op Ar modifier
.Ar panel Op , Ar ...
.Xc
Change which panels are shown.
.Ar modifier
may be
.Sq + ,
which enables panels,
.Sq - ,
which disables panels, or left blank, which makes
.Nm
show only the specified panels.
.Pp
The following panels are available:
.Pp
.Bl -tag -width compassXX -offset indent -compact
.It Ic compass
Compass.
.It Ic wiadj
Wired-mode spacing controls.
.It Ic legend
Node class legend.
.It Ic Help
Help.
.El
.It Ic playreel Ar delay archive
Play a data archive reel.
Each frames is shown for
.Ar delay
milliseconds.
.Ar archive
specifies the reel directory and must be surrounding by double quote
characters
.Pq Dq .
.It Xo
.Ic pstick
.Ar stick
.Ar panel Op , Ar ...
.Xc
Change the panel
.Dq stick
i.e. position of the given panels.
Recognized
.Ar stick
values are:
.Pp
.Bl -tag -width Ds -offset indent -compact
.It Ic tl
Top-left.
.It Ic tr
Top-right.
.It Ic bl
Bottom-left.
.It Ic br
Bottom-right.
.El
.It Ic refocus
Move the camera view to point to the current focus, which will
be the center of all selected nodes, if there are any, or otherwise
the entire cluster view.
.It Ic refresh
Grab new data.
.It Ic seljob random
Select a random job-allocated node and highlight its respective job.
.It Ic selnode Ar nid
Select the node with the given node ID
.Ar nid .
.Ar nid
may also be
.Ic random ,
in which case a random node will be selected.
.It Ic setcap Ar caption
If the caption option is enabled, the caption displayed will be
changed to the given
.Ar caption .
Captions may be optionally surrounded by double quotes
.Pq Dq \&
to allow spaces.
.It Ic subsel visible
Set the subselection to all currently visible nodes.
Only nodes in the subselection will be visible when the
.Em subset
option is enabled.
.It Ic vmode Ar vm
Set the current cluster view mode.
Recognized values for
.Ar vm
are
.Ic phys , wione ,
and
.Ic wired .
.It Ic winsp Ar x y z
Set the wired-mode node spacing factor.
Each of
.Ar x , y ,
or
.Ar z
may be prefixed by a
.Sq + ,
which will increase the spacing by the given factor,
.Sq - ,
which will decrease the spacing factor, or nothing, in which case the
spacing factor for that dimension will be set to the given value.
.It Ic wioff Ar x y z
Set the wired-mode node offset.
Each of
.Ar x , y ,
or
.Ar z
may be prefixed by a
.Sq + ,
which will increase the offset,
.Sq - ,
which will decrease the offset, or nothing, in which case the
offset in that dimension will be set to the given value.
.El
.Sh FILES
.Bl -tag -width Pa -compact
.It Pa img/tex-sc Ns Em %d Ns Pa .png
node state textures
.It Pa img/tex-selnode.png
selected node texture
.It Pa img/font.png
font texture used for node labels
.It Pa data/archive/
top-level reel directory
.It Pa data/latest-archive
latest reel directory
.It Pa data/phys.conf
cluster physical description file
.It Pa data/colors
job color table
.It Pa data/node
node information
.It Pa data/job
job information
.It Pa data/yod
yod information
.It Pa data/ss
seastar data
.It Pa data/rt
routing data
.It Pa data/flybys/
flyby data files
.It Pa data/flybys/default
default flyby file
.It Pa scripts/
deus-ex scripts
.It Pa snaps/ Ns Em %08d Ns Pa .png
capture output files
.El
.Sh COPYRIGHT
Copyright
.Pq c
2005-2006 Pittsburgh Supercomputing Center
http://www.psc.edu/
.Pp
Distributed binaries contain and/or are linked with the following bits
of software and their respective licenses:
.Pp
.Bl -tag -width freeglutX -offset indent -compact
.It libpng
http://www.libpng.org/pub/png/libpng-1.2.5-manual.html#section-10
.It zlib
http://www.zlib.net/zlib_license.html
.It freeglut
http://www.opensource.org/licenses/mit-license.php
.It openssl
http://www.openssl.org/source/license.html
.El
